var Je=Object.defineProperty;var Xe=(t,e,n)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var B=(t,e,n)=>(Xe(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function A(){}function Ke(t,e){for(const n in e)t[n]=e[n];return t}function De(t){return t()}function Ne(){return Object.create(null)}function G(t){t.forEach(De)}function Ie(t){return typeof t=="function"}function J(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ue(t){return Object.keys(t).length===0}function Ve(t,e,n,s){if(t){const i=je(t,e,n,s);return t[0](i)}}function je(t,e,n,s){return t[1]&&s?Ke(n.ctx.slice(),t[1](s(e))):n.ctx}function Ge(t,e,n,s){if(t[2]&&s){const i=t[2](s(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const a=[],o=Math.max(e.dirty.length,i.length);for(let r=0;r<o;r+=1)a[r]=e.dirty[r]|i[r];return a}return e.dirty|i}return e.dirty}function Qe(t,e,n,s,i,a){if(i){const o=je(e,n,s,a);t.p(o,i)}}function We(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let s=0;s<n;s++)e[s]=-1;return e}return-1}function x(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function q(t){t.parentNode&&t.parentNode.removeChild(t)}function Ye(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function Ze(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ge(t){return document.createTextNode(t)}function H(){return ge(" ")}function R(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function oe(t){return function(e){return e.preventDefault(),t.call(this,e)}}function f(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $e(t){return Array.from(t.childNodes)}function et(t,e){e=""+e,t.data!==e&&(t.data=e)}function I(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function pe(t,e,n){t.classList.toggle(e,!!n)}function tt(t,e,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:s})}class nt{constructor(e=!1){B(this,"is_svg",!1);B(this,"e");B(this,"n");B(this,"t");B(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,s=null){this.e||(this.is_svg?this.e=Ze(n.nodeName):this.e=E(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(s)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)M(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(q)}}let he;function fe(t){he=t}function Ee(){if(!he)throw new Error("Function called outside component initialization");return he}function Se(t){Ee().$$.on_mount.push(t)}function Fe(t){Ee().$$.on_destroy.push(t)}function Le(){const t=Ee();return(e,n,{cancelable:s=!1}={})=>{const i=t.$$.callbacks[e];if(i){const a=tt(e,n,{cancelable:s});return i.slice().forEach(o=>{o.call(t,a)}),!a.defaultPrevented}return!0}}const ne=[],V=[];let le=[];const we=[],st=Promise.resolve();let Te=!1;function it(){Te||(Te=!0,st.then(Be))}function xe(t){le.push(t)}function se(t){we.push(t)}const ve=new Set;let ee=0;function Be(){if(ee!==0)return;const t=he;do{try{for(;ee<ne.length;){const e=ne[ee];ee++,fe(e),lt(e.$$)}}catch(e){throw ne.length=0,ee=0,e}for(fe(null),ne.length=0,ee=0;V.length;)V.pop()();for(let e=0;e<le.length;e+=1){const n=le[e];ve.has(n)||(ve.add(n),n())}le.length=0}while(ne.length);for(;we.length;)we.pop()();Te=!1,ve.clear(),fe(t)}function lt(t){if(t.fragment!==null){t.update(),G(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(xe)}}function at(t){const e=[],n=[];le.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),le=e}const _e=new Set;let W;function ot(){W={r:0,c:[],p:W}}function rt(){W.r||G(W.c),W=W.p}function F(t,e){t&&t.i&&(_e.delete(t),t.i(e))}function X(t,e,n,s){if(t&&t.o){if(_e.has(t))return;_e.add(t),W.c.push(()=>{_e.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function qe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ie(t,e,n){const s=t.$$.props[e];s!==void 0&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function ae(t){t&&t.c()}function Y(t,e,n){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),xe(()=>{const a=t.$$.on_mount.map(De).filter(Ie);t.$$.on_destroy?t.$$.on_destroy.push(...a):G(a),t.$$.on_mount=[]}),i.forEach(xe)}function Z(t,e){const n=t.$$;n.fragment!==null&&(at(n.after_update),G(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(t,e){t.$$.dirty[0]===-1&&(ne.push(t),it(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(t,e,n,s,i,a,o,r=[-1]){const d=he;fe(t);const l=t.$$={fragment:null,ctx:[],props:a,update:A,not_equal:i,bound:Ne(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:Ne(),dirty:r,skip_bound:!1,root:e.target||d.$$.root};o&&o(l.root);let S=!1;if(l.ctx=n?n(t,e.props||{},(p,_,...w)=>{const m=w.length?w[0]:_;return l.ctx&&i(l.ctx[p],l.ctx[p]=m)&&(!l.skip_bound&&l.bound[p]&&l.bound[p](m),S&&ct(t,p)),_}):[],l.update(),S=!0,G(l.before_update),l.fragment=s?s(l.ctx):!1,e.target){if(e.hydrate){const p=$e(e.target);l.fragment&&l.fragment.l(p),p.forEach(q)}else l.fragment&&l.fragment.c();e.intro&&F(t.$$.fragment),Y(t,e.target,e.anchor),Be()}fe(d)}class U{constructor(){B(this,"$$");B(this,"$$set")}$destroy(){Z(this,1),this.$destroy=A}$on(e,n){if(!Ie(n))return A;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!Ue(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ut="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ut);const te=[];function dt(t,e=A){let n;const s=new Set;function i(r){if(J(t,r)&&(t=r,n)){const d=!te.length;for(const l of s)l[1](),te.push(l,t);if(d){for(let l=0;l<te.length;l+=2)te[l][0](te[l+1]);te.length=0}}}function a(r){i(r(t))}function o(r,d=A){const l=[r,d];return s.add(l),s.size===1&&(n=e(i,a)||A),r(t),()=>{s.delete(l),s.size===0&&n&&(n(),n=null)}}return{set:i,update:a,subscribe:o}}const me=dt(!1);function ft(t){let e,n,s,i,a,o,r,d,l,S,p;return{c(){e=E("div"),n=E("div"),s=H(),i=E("div"),a=E("form"),o=E("div"),r=E("div"),d=H(),l=E("div"),l.innerHTML='<p class="control"><button type="submit" class="button is-success svelte-1vm7l7d" title="Подтвердить"><span class="icon is-small"><i class="fa-light fa-check"></i></span><span>Да</span></button></p> <p class="control"><button type="reset" class="button is-danger is-outlined svelte-1vm7l7d" title="Отменить"><span class="icon is-small"><i class="fa-light fa-xmark"></i></span><span>Нет</span></button></p>',f(n,"class","modal-background"),f(r,"class","container content"),f(l,"class","field is-grouped is-grouped-centered"),f(o,"class","message-body"),f(a,"class","message is-warning"),f(i,"class","modal-content"),f(e,"class","modal"),pe(e,"is-active",t[0])},m(_,w){M(_,e,w),x(e,n),x(e,s),x(e,i),x(i,a),x(a,o),x(o,r),r.innerHTML=t[1],x(o,d),x(o,l),S||(p=[R(n,"click",t[3]),R(a,"submit",oe(t[2])),R(a,"reset",oe(t[3]))],S=!0)},p(_,[w]){w&2&&(r.innerHTML=_[1]),w&1&&pe(e,"is-active",_[0])},i:A,o:A,d(_){_&&q(e),S=!1,G(p)}}}let Ce="modalevent";function mt(t,e,n){const s=Le();let{htmldata:i="Sample modal data"}=e,{active:a=!1}=e,o=!1;const r=()=>{o=!0,n(0,a=!1),s(Ce,o)},d=()=>{o=!1,n(0,a=!1),s(Ce,o)};return t.$$set=l=>{"htmldata"in l&&n(1,i=l.htmldata),"active"in l&&n(0,a=l.active)},[a,i,r,d]}class ht extends U{constructor(e){super(),K(this,e,mt,ft,J,{htmldata:1,active:0})}}function _t(t){let e,n,s,i,a,o,r,d,l,S,p;function _(m){t[5](m)}let w={htmldata:pt};return t[1]!==void 0&&(w.active=t[1]),r=new ht({props:w}),V.push(()=>ie(r,"active",_)),r.$on("modalevent",t[3]),{c(){e=E("button"),n=E("i"),s=H(),i=E("div"),o=H(),ae(r.$$.fragment),f(n,"class","fa-light fa-trash-xmark"),f(i,"id","tgen_change_inform"),f(e,"type","submit"),f(e,"class","button is-link is-outlined mt-1 ml-2"),e.disabled=a=!t[0],f(e,"title","Удалить отмеченные")},m(m,N){M(m,e,N),x(e,n),x(e,s),x(e,i),M(m,o,N),Y(r,m,N),l=!0,S||(p=R(e,"click",oe(t[2])),S=!0)},p(m,[N]){(!l||N&1&&a!==(a=!m[0]))&&(e.disabled=a);const g={};!d&&N&2&&(d=!0,g.active=m[1],se(()=>d=!1)),r.$set(g)},i(m){l||(F(r.$$.fragment,m),l=!0)},o(m){X(r.$$.fragment,m),l=!1},d(m){m&&(q(e),q(o)),Z(r,m),S=!1,p()}}}let pt="<p>Удаление <span class='has-text-danger-dark'>необратимо</span>! Удалить?</p>";const gt="notification";function bt(t,e,n){let{uriPath:s=""}=e;const i=document.querySelector("[name=csrfmiddlewaretoken]").value,a="https://"+document.domain+app.dataset.api;let o=!1;const r=Le();let{disabled:d=!0}=e,l=me.subscribe(g=>n(0,d=g));Fe(l);const S={add_class:"is-danger",text:"Не удалось удалить:"};let p=null;const _=g=>{p=g.currentTarget,n(1,o=!0)};async function w(g){if(!g.detail)return;const k=p.parentElement;let T="";const b=new FormData(k);for(let h of b.values())h&&(T+=await m(h));if(r("updatetable"),T){let h={...S};h.text+=T,r(gt,h)}me.update(h=>!1)}const m=async g=>{try{const k=await fetch(`${a}${g}/`,{method:"delete",headers:{"X-CSRFToken":i}});return k.ok?"":`<br> id: ${g}, ${k.status} - ${k.statusText}`}catch(k){return`<br> id: ${g}, ${k.message}`}};function N(g){o=g,n(1,o)}return t.$$set=g=>{"uriPath"in g&&n(4,s=g.uriPath),"disabled"in g&&n(0,d=g.disabled)},[d,o,_,w,s,N]}class yt extends U{constructor(e){super(),K(this,e,bt,_t,J,{uriPath:4,disabled:0})}}function vt(t){let e,n,s;return{c(){e=E("table"),e.innerHTML="",n=H(),s=E("div"),s.textContent="...",f(e,"class","table is-hoverable is-striped has-background-white-ter svelte-qssaav"),f(e,"id","T_gen"),f(s,"id","observer_target"),I(s,"width","15rem"),I(s,"height","20px"),I(s,"border","none"),I(s,"margin","0 0 0 1rem"),I(s,"font-size","0.8rem")},m(i,a){M(i,e,a),M(i,n,a),M(i,s,a)},p:A,i:A,o:A,d(i){i&&(q(e),q(n),q(s))}}}const Me="has-background-warning-light",Ae="tablegen-all",ke=10;function D(t,e={}){let n=document.createElement(t);for(let s in e)n.setAttribute(s,e[s]);return n}function kt(t,e,n){let{href:s="/item/"}=e,{checkbox_name:i="id"}=e,{url:a=""}=e,{fields:o=["id"]}=e,{parseData:r=void 0}=e,d=0;Fe(()=>me.update(v=>!1));const l=new Set;function S(v){let u=v.currentTarget;p(u)}const p=v=>{const u=document.querySelector("tr th.firstcell label input");v.checked?(l.add(v.value),me.update(c=>!0),v.parentNode.parentNode.parentNode.classList.add(Me),document.querySelector("#tgen_change_inform").innerHTML=""+l.size,u.classList.add("haschecked")):(document.querySelector(`#${Ae}`).checked=!1,l.delete(v.value),document.querySelector("#tgen_change_inform").innerHTML=""+l.size,l.size==0&&(me.update(c=>!1),document.querySelector("#tgen_change_inform").innerHTML="",u.classList.remove("haschecked")),v.parentNode.parentNode.parentNode.classList.remove(Me))},_=v=>{let u=v.currentTarget,c=document.getElementsByName(i);if(u.checked)for(let y of c)y.checked=!0,p(y);else for(let y of c)y.checked=!1,p(y)},w=v=>{const u={name:"Наименование",address:"Адрес",inn:"ИНН",kpp:"КПП",ogrn:"ОГРН",bank:"Банк",bik:"БИК",pay_account:"Номер счёта",kor_account:"Корр. счёт",phone:"Телефон",number:"Номер",date:"Дата",city:"Город",truck:"Авто",spec_notes:"Особые отметки",destination_address:"Адрес назначения",text:"Условия договора",sender:"Отправитель",receiver:"Получатель",payer:"Плательщик",created:" ",modified:" ",document:"Документ",doc_sum:"Сумма"};return u[v]?u[v]:v};function m(v){return r?r(v):JSON.parse(JSON.stringify(v,o))}class N{constructor(u=!0,c="",y=void 0,L=!0,P="",O=void 0){this.item1=c,this.minus1=u,this.tag1=y,this.item2=P,this.minus2=L,this.tag2=O}add(u,c,y){return c!==this.item1&&(this.tag2&&(this.tag2.setAttribute("state",0),this.tag2.querySelector("i").className="fa-light fa-sort"),this.item2=this.item1,this.minus2=this.minus1,this.tag2=this.tag1,this.item1=c,this.tag1=y,y.style.color="chocolate",this.tag2&&(this.tag2.style.color="grey")),this.minus1=u,this.str()}clear(){return this.tag1&&(this.item1=this.item2="",this.minus1=this.minus2=!0,this.tag2&&(this.tag2.setAttribute("state",0),this.tag2.querySelector("i").className="fa-light fa-sort"),this.tag1.setAttribute("state",0),this.tag1.querySelector("i").className="fa-light fa-sort",this.tag1=this.tag2=void 0),""}str(){const u=this.minus1?"-":"",c=this.minus2?"-":"";let y=this.item1?"&o="+u+this.item1:"",L=this.item2?"&o="+c+this.item2:"";return y+L}has(u){return this.item1===u||this.item2===u}reverse(){this.item1&&(this.minus1=!this.minus1)}}class g{constructor(){this.data={}}add(u,c=""){this.data[u]=c}del(u){this.add(u,"")}str(){let u="";for(let c in this.data)u+=this.data[c]?"&"+c+"="+this.data[c]:"";return u}}let k=new g,T=new N;async function b(){const v="&q="+ke,u=d?"&s="+d:"";let c=`${v}${u}${T.str()}${k.str()}`;c=c?c.replace("&","?"):"";const y=await fetch(`${a}${c}`).then(L=>L.json());return d=y.length<ke?-1:d+ke,m(y)}class h{constructor(u="",c="td",y={}){this.tagname=c,this.element=D(c,y),u&&(this.element.innerHTML=u)}append(u){this.element.appendChild(u)}}class C{constructor(u={}){B(this,"appendCells",u=>{const c="<a href='"+s+u.id+"'>"+u[Object.keys(u)[1]]+"</a>";for(const y in u)if(y==="id"){const L=D("input",{type:"checkbox",name:i,value:u[y]});L.addEventListener("change",S);const P=D("label");P.appendChild(L);const O=new h("","td",{class:"firstcell"});O.append(P),this.append(O.element)}else{const L=new h(u[y]);this.append(L.element)}this.element.children[1].innerHTML=c});B(this,"appendThCells",u=>{for(const c in u){const y=D("div",{class:"field has-addons"});let L=D("div",{class:"control is-expanded"});const P=D("input",{class:"input is-small",type:"search",placeholder:w(c),name:c});P.addEventListener("change",j),L.appendChild(P),y.appendChild(L),L=D("a",{class:"control",name:c,state:0}),y.appendChild(L);const O=D("span",{class:"icon"});L.appendChild(O),O.appendChild(D("i",{class:"fa-light fa-sort"}));const Q=new h("","th");Q.append(y),this.append(Q.element),L.addEventListener("click",z)}});this.element=D("tr",u)}append(u){this.element.appendChild(u)}}function z(v){const u=v.currentTarget,c=u.getAttribute("state"),y=u.getAttribute("name"),L=u.querySelector("i"),P="fa-light fa-sort-down",O="fa-light fa-sort-up",Q="fa-light fa-sort";u.preventDefault,c==0?(T.add(!1,y,u),u.setAttribute("state",1),L.className=P):c==1?(T.add(!0,y,u),u.setAttribute("state",2),L.className=O):(T.clear(),u.setAttribute("state",0),L.className=Q),ue()}function j(v){const u=v.currentTarget;k.add(u.name,u.value),ue()}const re=new IntersectionObserver(ye,{root:document.querySelector("#tablegen_id"),threshold:.5});let $=!1;const ce=D("tbody");async function be(){const v=document.querySelector("#T_gen"),u=D("thead"),c=new C,y=await b(),L=D("input",{type:"checkbox",id:Ae});L.addEventListener("change",_);const P=D("label");P.appendChild(L);const O=new h("","th",{class:"firstcell"});O.append(P),c.append(O.element);const Q={...y[0]};delete Q.id,c.appendThCells(Q),u.appendChild(c.element),v.appendChild(u),v.appendChild(ce),de(y),setTimeout(()=>re.observe(document.querySelector("#observer_target")),200),$=!0,document.querySelector("#tgen_change_inform").innerHTML=""}async function ue(){const u=document.querySelector("#T_gen").querySelector("tbody");u.innerHTML="",d=0,document.querySelector("#observer_target").innerHTML="...";const c=await b();de(c),!$&&(setTimeout(()=>re.observe(document.querySelector("#observer_target")),200),$=!0)}function de(v){for(const u of v){const c=new C;c.appendCells(u),ce.appendChild(c.element)}}function ye(v,u){const c=document.querySelector("#observer_target");if(d===-1){u.unobserve(c),$=!1,c.innerHTML="Конец списка";return}v.forEach(async y=>{if(y.isIntersecting){const L=await b();de(L)}}),u.unobserve(c),setTimeout(()=>u.observe(c),200)}return Se(be),t.$$set=v=>{"href"in v&&n(0,s=v.href),"checkbox_name"in v&&n(1,i=v.checkbox_name),"url"in v&&n(2,a=v.url),"fields"in v&&n(3,o=v.fields),"parseData"in v&&n(4,r=v.parseData)},[s,i,a,o,r]}class wt extends U{constructor(e){super(),K(this,e,kt,vt,J,{href:0,checkbox_name:1,url:2,fields:3,parseData:4})}}function Tt(t){let e,n,s,i,a,o,r;return{c(){e=E("div"),n=new nt(!1),s=ge("  "),i=E("button"),n.a=s,f(i,"class","delete"),f(e,"id",xt),f(e,"class",a="notification "+t[2]),I(e,"opacity",t[3]),I(e,"position","fixed"),I(e,"bottom","3rem"),I(e,"right","3rem"),I(e,"font-size","1rem"),I(e,"display",t[0])},m(d,l){M(d,e,l),n.m(t[1],e),x(e,s),x(e,i),o||(r=R(i,"click",t[4]),o=!0)},p(d,[l]){l&2&&n.p(d[1]),l&4&&a!==(a="notification "+d[2])&&f(e,"class",a),l&8&&I(e,"opacity",d[3]),(l&8||l&9)&&I(e,"display",d[0])},i:A,o:A,d(d){d&&q(e),o=!1,r()}}}const xt="svelt-notyfycation";function Et(t,e,n){let{text:s="Test text"}=e,{add_class:i="is-warning"}=e,{display:a="none"}=e;const o=()=>{let l;return i.includes("is-danger")||i.includes("is-warning")?l=.5:l=.4,l};let r=o();const d=()=>n(0,a="none");return t.$$set=l=>{"text"in l&&n(1,s=l.text),"add_class"in l&&n(2,i=l.add_class),"display"in l&&n(0,a=l.display)},t.$$.update=()=>{t.$$.dirty&1&&a=="block"&&n(3,r=o())},[a,s,i,r,d]}class St extends U{constructor(e){super(),K(this,e,Et,Tt,J,{text:1,add_class:2,display:0})}}function Lt(t){let e,n,s,i,a;return{c(){e=E("div"),n=E("div"),s=ge(t[0]),i=H(),a=E("input"),f(n,"class","input-placeholder svelte-9h7o5m"),f(a,"type",t[2]),f(a,"class","input-min svelte-9h7o5m"),f(a,"name",t[1]),f(a,"maxlength",t[4]),f(e,"class","input-out svelte-9h7o5m"),f(e,"title",t[3])},m(o,r){M(o,e,r),x(e,n),x(n,s),x(e,i),x(e,a)},p(o,[r]){r&1&&et(s,o[0]),r&4&&f(a,"type",o[2]),r&2&&f(a,"name",o[1]),r&16&&f(a,"maxlength",o[4]),r&8&&f(e,"title",o[3])},i:A,o:A,d(o){o&&q(e)}}}function Nt(t,e,n){let{label:s="label"}=e,{name:i="name"}=e,{type:a="text"}=e,{title:o=""}=e,{maxlength:r=256}=e;return t.$$set=d=>{"label"in d&&n(0,s=d.label),"name"in d&&n(1,i=d.name),"type"in d&&n(2,a=d.type),"title"in d&&n(3,o=d.title),"maxlength"in d&&n(4,r=d.maxlength)},[s,i,a,o,r]}class qt extends U{constructor(e){super(),K(this,e,Nt,Lt,J,{label:0,name:1,type:2,title:3,maxlength:4})}}function ze(t,e,n){const s=t.slice();return s[16]=e[n],s}function Oe(t){let e,n;return e=new qt({props:{name:t[16].name,label:t[16].placeholder,maxlength:t[16].maxlength,type:t[16].type}}),{c(){ae(e.$$.fragment)},m(s,i){Y(e,s,i),n=!0},p:A,i(s){n||(F(e.$$.fragment,s),n=!0)},o(s){X(e.$$.fragment,s),n=!1},d(s){Z(e,s)}}}function He(t){let e;return{c(){e=E("input"),f(e,"type","hidden"),f(e,"name","id"),f(e,"class","svelte-1sbx7jg")},m(n,s){M(n,e,s)},d(n){n&&q(e)}}}function Ct(t){let e,n,s,i,a,o,r,d,l,S,p,_,w=qe(t[2]),m=[];for(let k=0;k<w.length;k+=1)m[k]=Oe(ze(t,w,k));const N=k=>X(m[k],1,1,()=>{m[k]=null});let g=t[0]&&He();return{c(){e=E("form");for(let k=0;k<m.length;k+=1)m[k].c();n=H(),g&&g.c(),s=H(),i=E("div"),a=E("div"),o=E("button"),r=ge("Сохранить"),d=H(),l=E("div"),l.innerHTML='<button type="reset" class="button is-fullwidth">Отмена</button>',f(o,"type","submit"),f(o,"class","button is-link is-fullwidth"),o.disabled=t[1],f(a,"class","control is-expanded"),f(l,"class","control is-expanded"),f(i,"class","field is-grouped is-grouped-centered"),f(e,"method","post"),f(e,"class","box"),f(e,"id","organizationform")},m(k,T){M(k,e,T);for(let b=0;b<m.length;b+=1)m[b]&&m[b].m(e,null);x(e,n),g&&g.m(e,null),x(e,s),x(e,i),x(i,a),x(a,o),x(o,r),x(i,d),x(i,l),S=!0,p||(_=[R(e,"submit",oe(t[3])),R(e,"reset",t[4])],p=!0)},p(k,[T]){if(T&4){w=qe(k[2]);let b;for(b=0;b<w.length;b+=1){const h=ze(k,w,b);m[b]?(m[b].p(h,T),F(m[b],1)):(m[b]=Oe(h),m[b].c(),F(m[b],1),m[b].m(e,n))}for(ot(),b=w.length;b<m.length;b+=1)N(b);rt()}k[0]?g||(g=He(),g.c(),g.m(e,s)):g&&(g.d(1),g=null),(!S||T&2)&&(o.disabled=k[1])},i(k){if(!S){for(let T=0;T<w.length;T+=1)F(m[T]);S=!0}},o(k){m=m.filter(Boolean);for(let T=0;T<m.length;T+=1)X(m[T]);S=!1},d(k){k&&q(e),Ye(m,k),g&&g.d(),p=!1,G(_)}}}const Mt="notification";function At(t){const e=document.querySelector("#organizationform");for(let n in t)e[n].parentNode.style.border="1px solid red",e[n].parentNode.setAttribute("title",t[n]),e[n].addEventListener("input",s=>{s.currentTarget.parentNode.removeAttribute("title"),s.currentTarget.parentNode.style.border="1px solid #999"},{once:!0})}function Pe(t){t.currentTarget.value=t.currentTarget.value.replace(/\D/g,"")}function zt(t,e,n){let{id:s=void 0}=e;const i=Le(),a={add_class:"is-danger",text:"Не удалось сохранить: <br>"},o=[{name:"name",placeholder:"Название организации",type:"text",maxlength:50,onlynumbers:!1},{name:"address",placeholder:"Адрес",type:"text",maxlength:256,onlynumbers:!1},{name:"inn",placeholder:"ИНН",type:"text",maxlength:10,onlynumbers:!0},{name:"kpp",placeholder:"КПП",type:"text",maxlength:9,onlynumbers:!0},{name:"ogrn",placeholder:"ОГРН",type:"text",maxlength:15,onlynumbers:!0},{name:"bank",placeholder:"Наименование банка",type:"text",maxlength:150,onlynumbers:!1},{name:"bik",placeholder:"БИК",type:"text",maxlength:9,onlynumbers:!0},{name:"pay_account",placeholder:"Расчетный счет",type:"text",maxlength:20,onlynumbers:!0},{name:"kor_account",placeholder:"Корр. счет",type:"text",maxlength:20,onlynumbers:!0},{name:"phone",placeholder:"Номера телефонов",type:"text",maxlength:40,onlynumbers:!1},{name:"email",placeholder:"Email",type:"email",maxlength:254,onlynumbers:!1}],r="https://"+document.domain+app.dataset.api,d=document.querySelector("[name=csrfmiddlewaretoken]").value,l=async function(b,h="post"){let C=r;s&&(C+=s+"/");try{const z=await fetch(C,{method:h,headers:{"Content-Type":"application/json","X-CSRFToken":d},body:b});if(z.ok)return i("updatetable"),!0;throw At(await z.json()),new Error(`${z.status} - ${z.statusText}`)}catch(z){let j={...a};return j.text=z.message,i(Mt,j),!1}},S=async b=>{let h=b.currentTarget;const C=new FormData(h);let z=JSON.stringify(Object.fromEntries(C.entries())),j="post";s?j="patch":z.id="",await l(z,j)&&h.reset()},p=()=>{n(5,m=""),n(6,g=""),n(0,s=""),i("close")};let _=!0;async function w(){const b=document.querySelector("#organizationform"),h=await fetch(`${r}${s}/`).then(C=>C.json());for(let C in h)b[C].value=h[C];n(5,m=h.name),n(6,g=h.inn)}let m="";function N(b){n(5,m=b.currentTarget.value)}let g="";function k(b){Pe(b),n(6,g=b.currentTarget.value)}const T=()=>{const b=document.querySelector("#organizationform");b.name.addEventListener("input",h=>N(h)),b.inn.addEventListener("input",h=>k(h));for(let h of o)h.onlynumbers&&b[h.name].addEventListener("input",C=>Pe(C))};return Se(()=>{T(),s&&w()}),t.$$set=b=>{"id"in b&&n(0,s=b.id)},t.$$.update=()=>{t.$$.dirty&96&&n(1,_=!(g.length===10&&m.length>3))},[s,_,o,S,p,m,g]}class Ot extends U{constructor(e){super(),K(this,e,zt,Ct,J,{id:0})}}function Ht(t){let e,n,s,i,a,o,r,d,l;const S=t[4].default,p=Ve(S,t,t[3],null);return{c(){e=E("div"),n=E("div"),s=H(),i=E("div"),p&&p.c(),a=H(),o=E("button"),f(n,"class","modal-background"),f(i,"class","modal-content"),f(i,"style",t[2]),f(o,"class","modal-close is-large"),f(o,"aria-label","close"),f(e,"class","modal"),f(e,"style",t[1]),pe(e,"is-active",t[0])},m(_,w){M(_,e,w),x(e,n),x(e,s),x(e,i),p&&p.m(i,null),x(e,a),x(e,o),r=!0,d||(l=R(o,"click",t[5]),d=!0)},p(_,[w]){p&&p.p&&(!r||w&8)&&Qe(p,S,_,_[3],r?Ge(S,_[3],w,null):We(_[3]),null),(!r||w&4)&&f(i,"style",_[2]),(!r||w&2)&&f(e,"style",_[1]),(!r||w&1)&&pe(e,"is-active",_[0])},i(_){r||(F(p,_),r=!0)},o(_){X(p,_),r=!1},d(_){_&&q(e),p&&p.d(_),d=!1,l()}}}function Pt(t,e,n){let{$$slots:s={},$$scope:i}=e,{active:a=!1}=e,{modal_style:o=""}=e,{content_style:r=""}=e;const d=()=>n(0,a=!1);return t.$$set=l=>{"active"in l&&n(0,a=l.active),"modal_style"in l&&n(1,o=l.modal_style),"content_style"in l&&n(2,r=l.content_style),"$$scope"in l&&n(3,i=l.$$scope)},[a,o,r,i,s,d]}class Dt extends U{constructor(e){super(),K(this,e,Pt,Ht,J,{active:0,modal_style:1,content_style:2})}}function It(t){let e;return{c(){e=E("div"),f(e,"id","organization_form_container")},m(n,s){M(n,e,s)},p:A,d(n){n&&q(e)}}}function jt(t){let e,n,s,i,a,o,r,d,l,S,p,_,w,m,N,g,k,T,b,h,C,z,j,re;function $(c){t[6](c)}let ce={$$slots:{default:[It]},$$scope:{ctx:t}};t[2]!==void 0&&(ce.active=t[2]),e=new Dt({props:ce}),V.push(()=>ie(e,"active",$));function be(c){t[7](c)}let ue={uriPath:"organizations"};t[1]!==void 0&&(ue.disabled=t[1]),l=new yt({props:ue}),V.push(()=>ie(l,"disabled",be)),l.$on("notification",t[4]),l.$on("updatetable",t[3]);function de(c){t[10](c)}function ye(c){t[11](c)}function v(c){t[12](c)}let u={};return t[0].dispaly!==void 0&&(u.display=t[0].dispaly),t[0].text!==void 0&&(u.text=t[0].text),t[0].add_class!==void 0&&(u.add_class=t[0].add_class),T=new St({props:u}),V.push(()=>ie(T,"display",de)),V.push(()=>ie(T,"text",ye)),V.push(()=>ie(T,"add_class",v)),{c(){ae(e.$$.fragment),s=H(),i=E("h4"),i.textContent="Список организаций",a=H(),o=E("form"),r=E("div"),d=H(),ae(l.$$.fragment),p=H(),_=E("button"),w=E("i"),N=H(),g=E("button"),g.innerHTML='<i class="fa-light fa-plus"></i>',k=H(),ae(T.$$.fragment),f(i,"class","title is-4 pl-4 pt-5"),f(r,"id",Re),f(w,"class","fa-light fa-pen"),f(_,"class","button is-link is-outlined mt-1"),f(_,"title","Редактировать"),_.disabled=m=!t[1],f(g,"class","button is-link is-outlined mt-1"),f(g,"title","Добавить"),f(o,"class","svelte-vf04cj")},m(c,y){Y(e,c,y),M(c,s,y),M(c,i,y),M(c,a,y),M(c,o,y),x(o,r),x(o,d),Y(l,o,null),x(o,p),x(o,_),x(_,w),x(o,N),x(o,g),M(c,k,y),Y(T,c,y),z=!0,j||(re=[R(_,"click",oe(t[8])),R(g,"click",oe(t[9]))],j=!0)},p(c,[y]){const L={};y&131072&&(L.$$scope={dirty:y,ctx:c}),!n&&y&4&&(n=!0,L.active=c[2],se(()=>n=!1)),e.$set(L);const P={};!S&&y&2&&(S=!0,P.disabled=c[1],se(()=>S=!1)),l.$set(P),(!z||y&2&&m!==(m=!c[1]))&&(_.disabled=m);const O={};!b&&y&1&&(b=!0,O.display=c[0].dispaly,se(()=>b=!1)),!h&&y&1&&(h=!0,O.text=c[0].text,se(()=>h=!1)),!C&&y&1&&(C=!0,O.add_class=c[0].add_class,se(()=>C=!1)),T.$set(O)},i(c){z||(F(e.$$.fragment,c),F(l.$$.fragment,c),F(T.$$.fragment,c),z=!0)},o(c){X(e.$$.fragment,c),X(l.$$.fragment,c),X(T.$$.fragment,c),z=!1},d(c){c&&(q(s),q(i),q(a),q(o),q(k)),Z(e,c),Z(l),Z(T,c),j=!1,G(re)}}}const Ft="/organization/",Re="tablegen_id";function Bt(){let t=document.getElementById("tablegen_id").parentNode;return new FormData(t).get("id")}function Rt(t,e,n){const s={text:"",dispaly:"none",add_class:""};let i=!0,a=!1;const o="https://"+document.domain+app.dataset.api;let r;const d=async()=>{r==null||r.$destroy(),r=new wt({target:document.getElementById(Re),props:{url:o,fields:["id","name","inn","address","email","phone","bank"],href:Ft}})},l=h=>{n(0,s.text=h.detail.text,s),n(0,s.add_class=h.detail.add_class,s),n(0,s.dispaly="block",s),setTimeout(()=>{n(0,s.dispaly="none",s)},1e4)};function S(){n(2,a=!1)}let p;const _=(h="")=>{p==null||p.$destroy(),p=new Ot({target:document.querySelector("#organization_form_container"),props:{id:h}}),p.$on("updatetable",d),p.$on("notification",l),p.$on("close",S),n(2,a=!0)};Se(d),document.querySelector("#navbar-item-organizations").classList.add("is-active");function w(h){a=h,n(2,a)}function m(h){i=h,n(1,i)}const N=()=>_(Bt()),g=()=>_();function k(h){t.$$.not_equal(s.dispaly,h)&&(s.dispaly=h,n(0,s))}function T(h){t.$$.not_equal(s.text,h)&&(s.text=h,n(0,s))}function b(h){t.$$.not_equal(s.add_class,h)&&(s.add_class=h,n(0,s))}return[s,i,a,d,l,_,w,m,N,g,k,T,b]}class Jt extends U{constructor(e){super(),K(this,e,Rt,jt,J,{})}}function Xt(t){let e,n;return e=new Jt({}),{c(){ae(e.$$.fragment)},m(s,i){Y(e,s,i),n=!0},p:A,i(s){n||(F(e.$$.fragment,s),n=!0)},o(s){X(e.$$.fragment,s),n=!1},d(s){Z(e,s)}}}class Kt extends U{constructor(e){super(),K(this,e,null,Xt,J,{})}}new Kt({target:document.getElementById("app")});
